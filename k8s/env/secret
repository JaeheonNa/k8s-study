# configMap이랑 거의 동일. 다만 두 가지 보안적인 요소가 추가됨.
# 1. key-value 쌍에서 value를 넣을 때, base64로 encoding 후 넣어야 함.
#   (pod로 주입이 될 때는 decoding돼서 원래 값으로 보임)
# 2. 일반적인 오브젝트 값들은 k8s DB에 저장되는데, secret은 memory에 저장됨.
#   1Mb만 저장 가능. memory를 쓰기 때문에 너무 많이 만들면 pod 성능에 영향을 줄 수 있음.

apiVersion: v1
kind: Secret
metadata:
    name: sec-dev
data:
    <KEY>: <VALUE-encoded(base64)>

spec:
    containers:
    - name: container
      image: najh0528/hello_8000
      envFrom:
      - secretRef:
            name: sec-dev


# 파일 기반으로 secret을 만들고, 이를 직접 주입할 수도 있음.
# 단, secret을 생성할 때, base64로 encoding을 수행하므로,
# 미리 파일 내 값들을 base64로 encoding하면, encoding이 이중으로 수행됨.

kubectl create secret generic <secret명> --from-file=<파일>

apiVersion: v1
kind: Pod
metadata:
    name: pod-1
spec:
    containers:
    - name: container
      image: najh0528/hello_8000
      env:
      - name: file
        valueFrom:
            configMapKeyRef:
                name: <secret명>
                key: <파일명>

